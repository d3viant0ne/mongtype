"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const types_1 = require("./types");
function Collection(props) {
    return function (target) {
        Reflect.defineMetadata(types_1.NAME_KEY, props.name, target.prototype);
    };
}
exports.Collection = Collection;
function Before(...events) {
    return function (target, name, descriptor) {
        for (const event of events) {
            const fns = Reflect.getMetadata(`${types_1.PRE_KEY}_${event}`, target) || [];
            fns.push(target[name].bind(target));
            Reflect.defineMetadata(`${types_1.PRE_KEY}_${event}`, fns, target);
        }
    };
}
exports.Before = Before;
function After(...events) {
    return function (target, name, descriptor) {
        for (const event of events) {
            const fns = Reflect.getMetadata(`${types_1.POST_KEY}_${event}`, target) || [];
            fns.push(target[name].bind(target));
            Reflect.defineMetadata(`${types_1.POST_KEY}_${event}`, fns, target);
        }
    };
}
exports.After = After;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVjb3JhdG9ycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9kZWNvcmF0b3JzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsbUNBQXVFO0FBRXZFLG9CQUEyQixLQUFzQjtJQUMvQyxNQUFNLENBQUMsVUFBUyxNQUFXO1FBQ3pCLE9BQU8sQ0FBQyxjQUFjLENBQUMsZ0JBQVEsRUFBRSxLQUFLLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUNqRSxDQUFDLENBQUM7QUFDSixDQUFDO0FBSkQsZ0NBSUM7QUFFRCxnQkFBdUIsR0FBRyxNQUFnQjtJQUN4QyxNQUFNLENBQUMsVUFBUyxNQUFXLEVBQUUsSUFBWSxFQUFFLFVBQXdDO1FBQ2pGLEdBQUcsQ0FBQSxDQUFDLE1BQU0sS0FBSyxJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDMUIsTUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxHQUFHLGVBQU8sSUFBSSxLQUFLLEVBQUUsRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDckUsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDcEMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxHQUFHLGVBQU8sSUFBSSxLQUFLLEVBQUUsRUFBRSxHQUFHLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDN0QsQ0FBQztJQUNILENBQUMsQ0FBQztBQUNKLENBQUM7QUFSRCx3QkFRQztBQUVELGVBQXNCLEdBQUcsTUFBZ0I7SUFDdkMsTUFBTSxDQUFDLFVBQVMsTUFBVyxFQUFFLElBQVksRUFBRSxVQUF3QztRQUNqRixHQUFHLENBQUEsQ0FBQyxNQUFNLEtBQUssSUFBSSxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBQzFCLE1BQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsR0FBRyxnQkFBUSxJQUFJLEtBQUssRUFBRSxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUN0RSxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztZQUNwQyxPQUFPLENBQUMsY0FBYyxDQUFDLEdBQUcsZ0JBQVEsSUFBSSxLQUFLLEVBQUUsRUFBRSxHQUFHLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDOUQsQ0FBQztJQUNILENBQUMsQ0FBQztBQUNKLENBQUM7QUFSRCxzQkFRQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5BTUVfS0VZLCBQUkVfS0VZLCBQT1NUX0tFWSwgQ29sbGVjdGlvblByb3BzIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBDb2xsZWN0aW9uKHByb3BzOiBDb2xsZWN0aW9uUHJvcHMpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHRhcmdldDogYW55KSB7XG4gICAgUmVmbGVjdC5kZWZpbmVNZXRhZGF0YShOQU1FX0tFWSwgcHJvcHMubmFtZSwgdGFyZ2V0LnByb3RvdHlwZSk7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBCZWZvcmUoLi4uZXZlbnRzOiBzdHJpbmdbXSkge1xuICByZXR1cm4gZnVuY3Rpb24odGFyZ2V0OiBhbnksIG5hbWU6IHN0cmluZywgZGVzY3JpcHRvcjogVHlwZWRQcm9wZXJ0eURlc2NyaXB0b3I8YW55Pikge1xuICAgIGZvcihjb25zdCBldmVudCBvZiBldmVudHMpIHtcbiAgICAgIGNvbnN0IGZucyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoYCR7UFJFX0tFWX1fJHtldmVudH1gLCB0YXJnZXQpIHx8IFtdO1xuICAgICAgZm5zLnB1c2godGFyZ2V0W25hbWVdLmJpbmQodGFyZ2V0KSk7XG4gICAgICBSZWZsZWN0LmRlZmluZU1ldGFkYXRhKGAke1BSRV9LRVl9XyR7ZXZlbnR9YCwgZm5zLCB0YXJnZXQpO1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIEFmdGVyKC4uLmV2ZW50czogc3RyaW5nW10pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHRhcmdldDogYW55LCBuYW1lOiBzdHJpbmcsIGRlc2NyaXB0b3I6IFR5cGVkUHJvcGVydHlEZXNjcmlwdG9yPGFueT4pIHtcbiAgICBmb3IoY29uc3QgZXZlbnQgb2YgZXZlbnRzKSB7XG4gICAgICBjb25zdCBmbnMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKGAke1BPU1RfS0VZfV8ke2V2ZW50fWAsIHRhcmdldCkgfHwgW107XG4gICAgICBmbnMucHVzaCh0YXJnZXRbbmFtZV0uYmluZCh0YXJnZXQpKTtcbiAgICAgIFJlZmxlY3QuZGVmaW5lTWV0YWRhdGEoYCR7UE9TVF9LRVl9XyR7ZXZlbnR9YCwgZm5zLCB0YXJnZXQpO1xuICAgIH1cbiAgfTtcbn1cbiJdfQ==